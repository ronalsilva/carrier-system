> **⚠️ This README was generated by AI, but everything it wrote was validated by me, Ronald. :) 

# Carrier System

Monolith with Fastify API, Prisma ORM, Jest for testing, Next.js frontend, and MongoDB database.

## Tech Stack Rationale

- **Prisma** – Type-safe ORM with excellent MongoDB support, schema-first approach, and auto-generated client. Simplifies migrations and keeps the data layer consistent across the codebase.
- **Fastify** – High-performance Node.js framework with low overhead, built-in validation (JSON Schema), and a plugin ecosystem. Ideal for APIs that need speed and type safety.
- **Jest** – Widely adopted testing framework with zero config, snapshot testing, and strong mocking support. Fits well with TypeScript and provides fast feedback during development.

> **⚠️ Prisma version:** This project requires **Prisma 6**. Prisma 7 does not support MongoDB yet, so do not upgrade until MongoDB support is added.

## Project Structure

```
carrier-system/
├── apps/
│   ├── api/                          # Backend Fastify (port 3002)
│   │   ├── src/
│   │   │   ├── app.ts                # API entry point
│   │   │   ├── server.ts             # Fastify server configuration
│   │   │   ├── modules/
│   │   │   │   ├── carrier/          # Carriers module
│   │   │   │   │   ├── carrier.controller.ts
│   │   │   │   │   ├── carrier.routes.ts
│   │   │   │   │   ├── carrier.schemas.ts
│   │   │   │   │   ├── carrier.service.ts
│   │   │   │   │   └── carrier.utils.ts
│   │   │   │   ├── login/            # Authentication module
│   │   │   │   │   ├── login.controller.ts
│   │   │   │   │   ├── login.routes.ts
│   │   │   │   │   ├── login.schemas.ts
│   │   │   │   │   └── login.service.ts
│   │   │   │   └── user/             # Users module
│   │   │   │       ├── user.controller.ts
│   │   │   │       ├── user.routes.ts
│   │   │   │       ├── user.schemas.ts
│   │   │   │       └── user.service.ts
│   │   │   ├── test/                 # Unit tests (Jest)
│   │   │   │   └── modules/
│   │   │   │       ├── carrier/
│   │   │   │       ├── login/
│   │   │   │       └── user/
│   │   │   └── utils/
│   │   │       ├── dbConnection.ts
│   │   │       ├── handleError.ts
│   │   │       ├── hash.ts
│   │   │       ├── schemaDeafault.ts
│   │   │       └── swaggerConfig.ts
│   │   ├── prisma/
│   │   │   ├── schema.prisma
│   │   │   └── generated/            # Prisma client (generated)
│   │   ├── package.json
│   │   └── tsconfig.json
│   │
│   └── web/                          # Frontend Next.js (port 3000)
│       ├── src/
│       │   ├── app/
│       │   ├── components/
│       │   └── lib/
│       │       └── api.ts             # HTTP client for the API
│       ├── .eslintrc.json
│       ├── next.config.ts
│       ├── tailwind.config.ts
│       ├── postcss.config.mjs
│       ├── package.json
│       └── tsconfig.json
│
├── .github/
│   └── workflows/
│       └── tests.yml                 # CI: ESLint, build, tests
├── .vscode/
│   ├── launch.json
│   ├── tasks.json
│   └── settings.json
├── package.json                       # Root with npm workspaces
├── package-lock.json
├── docker-compose.yml
└── README.md
```

## Prerequisites

- Node.js 22+
- MongoDB (or Docker)
- npm

## Configuration

1. **Install dependencies:**
   ```bash
   npm install
   ```

2. **Environment variables:**
   - Copy `apps/api/.env.example` to `apps/api/.env`
   - Configure:
     - `DATABASE_URL` – MongoDB connection string (default: `mongodb://localhost:27017/carriers-db`)
     - `JWT_SECRET` – Secret for JWT tokens
     - `PORT` – API port (default: 3002)

3. **Start MongoDB (Docker):**
   ```bash
   npm run docker
   ```
   Runs MongoDB 7 with replica set (required by Prisma).

4. **Database setup:**
   ```bash
   npm run db
   ```
   Pushes the Prisma schema and generates the client.

## Development

Run API and frontend in parallel:

```bash
npm run dev
```

Or use VS Code debug (F5) with the configured launch profile.

- **Frontend:** http://localhost:3000
- **API:** http://localhost:3002
- **Swagger:** http://localhost:3002/docs

Next.js proxies `/api/*` requests to the API on port 3002.

## Scripts

| Command | Description |
|---------|-------------|
| `npm run dev` | Start API + frontend in parallel |
| `npm run dev:api` | API only |
| `npm run dev:web` | Frontend only |
| `npm run build` | Build API and frontend |
| `npm run start` | Start API + frontend (production) |
| `npm run test` | Run API unit tests |
| `npm run lint` | Run ESLint on frontend |
| `npm run db` | Push schema + generate Prisma client |
| `npm run db:generate` | Generate Prisma client only |
| `npm run db:push` | Push schema to database only |
| `npm run docker` | Start MongoDB via Docker Compose |

## Production

```bash
npm run build
npm run start
```

## CI/CD

GitHub Actions workflow (`.github/workflows/tests.yml`) runs on push/PR to `main`:

1. **Lint** – ESLint on frontend
2. **Build & Test** – Prisma generate, build API + frontend, run unit tests

## Database

MongoDB connection string:

```
mongodb://localhost:27017/carriers-db
```

You can use tools like TablePlus, MongoDB Compass, or similar to connect to the database.
